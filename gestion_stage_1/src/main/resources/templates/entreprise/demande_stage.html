

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Candidatures Étudiants</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>
<div class="container mt-5">
    <h2 class="mb-4">Liste des Candidatures</h2>

    <div th:if="${#lists.isEmpty(demandes)}" class="alert alert-info">
        Aucune candidature reçue pour le moment.
    </div>
	
	<div class="table-responsive" th:if="${!#lists.isEmpty(demandes)}">

			<table class="table table-bordered">
			    <thead class="table-dark">
			        <tr>
			            <th>Date de Postulation</th>
			            <th>Nom Etudiant</th>
			            <th>Prénom Etudiant</th>
						<th>Message</th>
						<th>CV</th>
			
			            <th>Statut</th>
			            <th>Actions</th>
			        </tr>
			    </thead>
			    <tbody>
			        <tr th:each="demande : ${demandes}">
			            <!-- Afficher la date de la demande -->
						<td th:text="${demande.formattedDate}">Date</td>
			
			            <!-- Afficher le nom de l'étudiant -->
			            <td th:text="${demande.nomEtudiant}">Nom Etudiant</td>
			            <!-- Afficher le prénom de l'étudiant -->
			            <td th:text="${demande.prenomEtudiant}">Prénom Etudiant</td>
						<td th:text="${demande.message}">Message</td>
						<td>
							<a th:href="@{'/uploads/cvs/' + ${demande.cv}}" target="_blank">Voir CV</a>
			
						</td>
			
			            <!-- Afficher le statut de la demande -->
			            <td th:text="${demande.status}">Statut</td>
			            <td>
			                <!-- Formulaire pour accepter la demande -->
			                <form th:action="@{/entreprise/demande_stage/{id}/accepter(id=${demande.id})}" method="post" style="display:inline;">
			                    <button type="submit" class="btn btn-success" th:if="${demande.status != 'ACCEPTEE'}">Accepter</button>
			                </form>
			                <!-- Formulaire pour refuser la demande -->
			                <form th:action="@{/entreprise/demande_stage/{id}/refuser(id=${demande.id})}" method="post" style="display:inline;">
			                    <button type="submit" class="btn btn-danger" th:if="${demande.status != 'REFUSEE'}">Refuser</button>
			                </form>
			            </td>
			        </tr>
			    </tbody>
			</table>
			
		</div>
		<a href="/entreprise/dashboard" class="btn btn-secondary mt-3">← Retour</a>
	</div>

			<!-- Bootstrap JS (facultatif pour interaction dynamique) -->
			<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
			</body>
			</html>